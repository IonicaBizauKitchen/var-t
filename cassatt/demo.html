<!doctype html>
<html lang="en" id="cassatt-demo">

<head>
  <title>var t; //cassatt demo</title>
  <meta charset="utf-8" />

  <style type="text/css">
    body {  overflow: hidden; font-family: Helvetica; padding: 1em; }
    
    #container p { margin: 0 0 2em; }
    label { font-weight: bold; text-transform: uppercase; font-size: 1.5em; display: block; margin: .5em 0; width: 500px;}
    
    #menu { position: absolute; top: 10px; right: 10px; text-align: right;   }
    #menu a { text-decoration: none; color: black; font-weight: bold; font-size: 1.2em; }
    #menu p { margin-bottom: 10px; }
    #menu small { font-family: monospace; }
    
    .hide { display: none; }
  </style>
</head>

<body id="cassatt">

  <div id="container">
    <p>
      <label for="upload-image">1. upload an image</label>
      <input type="file" id="upload-image" name="upload-image" />
    </p>
    
    <p id="sketch-container" class="hide">
      <label>2. Draw around the edges to give it a Cassatt oil sketch look!</label>
      
      <canvas id="sketch-canvas"></canvas>
    </p>
  </div>

  <div id="menu"> 
    
    <div class="tray">
    <p><a href="index.html">DE-SKETCHING CASSATT<br /> a <code>var t;</code> demo</a></p>
    <p><small>upload an image<br />make it an art<br /><a href="index.html">learn about mary cassatt</a></small></p>
      <div id="sketch-tools" class="hide">
        <button class="clear">Clear</button>
        <button class="save">Save</button>
      </div>
    </div>
  </div>

  <script src="jquery-2.1.1.min.js" type="text/javascript"></script>
  <script type="text/javascript">
  $(function(){
    
    var $uploadInput = $('#upload-image');
    var $sketchContainer = $('#sketch-container');
    var $sketchTools = $('#sketch-tools');
    var canvas = $('#sketch-canvas')[0];
    var ctx = canvas.getContext('2d');
    
    var $buttonClear = $('button.clear');
    var $buttonSave = $('button.save');
    
    /** EVENTS **/
    
    // when uploading an image, embed it onto canvas and show it
    $uploadInput.change(function(){
      
      // embed image onto canvas
  	  var uploadedImage = $uploadInput[0].files[0];
  	  var reader = new FileReader();
      reader.onload = function(e){
        var img = new Image();
        img.onload =function() {
          canvas.width = img.width;
          canvas.height = img.height;
          ctx.drawImage(img,0,0);
        }
        img.src = e.target.result;
      };
      reader.readAsDataURL(uploadedImage);
          
      // show sketch container
      $sketchContainer.removeClass('hide');
      $sketchTools.removeClass('hide');
    });
    
    // clear canvas when clear button clicked
    $buttonClear.click(function(){
      ctx.fillStyle = "#ffffff";
      ctx.fillRect(0,0,canvas.width,canvas.height);
      
      $sketchContainer.addClass('hide');
      $sketchTools.addClass('hide');
    });
    
    // open png in new window when save button clicked
    $buttonSave.click(function(){
      window.open(canvas.toDataURL('image/png'));
    });
    
  });
  </script>

</body>
</html>